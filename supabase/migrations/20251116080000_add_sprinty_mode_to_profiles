-- Add sprinty_mode column to profiles table
ALTER TABLE public.profiles
ADD COLUMN sprinty_mode TEXT NOT NULL DEFAULT 'simple' CHECK (sprinty_mode IN ('simple', 'expert'));

-- Allow users to update their own sprinty_mode
-- We need to find the existing update policy and add this column to it.
-- For now, let's create a specific policy, which is safer if the other one is complex.

-- First, let's make sure the user can select their own profile to check the mode
CREATE POLICY "Allow users to read their own sprinty_mode"
ON public.profiles
FOR SELECT
USING (auth.uid() = id);

-- Then, allow them to update it
CREATE POLICY "Allow users to update their own sprinty_mode"
ON public.profiles
FOR UPDATE
USING (auth.uid() = id)
WITH CHECK (auth.uid() = id);
